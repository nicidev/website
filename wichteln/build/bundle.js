var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function s(e){e.forEach(t)}function i(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function o(e,t,n,s){if(e){const i=l(e,t,n,s);return e[0](i)}}function l(e,t,n,s){return e[1]&&s?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](s(t))):n.ctx}function c(e,t,n,s,i,r,o){const c=function(e,t,n,s){if(e[2]&&s){const i=e[2](s(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let s=0;s<n;s+=1)e[s]=t.dirty[s]|i[s];return e}return t.dirty|i}return t.dirty}(t,s,i,r);if(c){const i=l(t,n,s,o);e.p(i,c)}}function u(e){return null==e?"":e}function a(e,t){e.appendChild(t)}function d(e,t,n){e.insertBefore(t,n||null)}function h(e){e.parentNode.removeChild(e)}function f(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function g(){return p(" ")}function $(){return p("")}function E(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function b(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function N(e,t){e.value=null==t?"":t}function v(e,t,n){e.classList[n?"add":"remove"](t)}let O;function R(e){O=e}function _(){const e=function(){if(!O)throw new Error("Function called outside component initialization");return O}();return(t,n)=>{const s=e.$$.callbacks[t];if(s){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);s.slice().forEach((t=>{t.call(e,i)}))}}}function C(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const w=[],D=[],x=[],T=[],L=Promise.resolve();let S=!1;function k(e){x.push(e)}let I=!1;const A=new Set;function U(){if(!I){I=!0;do{for(let e=0;e<w.length;e+=1){const t=w[e];R(t),j(t.$$)}for(R(null),w.length=0;D.length;)D.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];A.has(t)||(A.add(t),t())}x.length=0}while(w.length);for(;T.length;)T.pop()();S=!1,I=!1,A.clear()}}function j(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(k)}}const M=new Set;let z;function K(){z={r:0,c:[],p:z}}function W(){z.r||s(z.c),z=z.p}function F(e,t){e&&e.i&&(M.delete(e),e.i(t))}function P(e,t,n,s){if(e&&e.o){if(M.has(e))return;M.add(e),z.c.push((()=>{M.delete(e),s&&(n&&e.d(1),s())})),e.o(t)}}function H(e){e&&e.c()}function V(e,n,r){const{fragment:o,on_mount:l,on_destroy:c,after_update:u}=e.$$;o&&o.m(n,r),k((()=>{const n=l.map(t).filter(i);c?c.push(...n):s(n),e.$$.on_mount=[]})),u.forEach(k)}function q(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function J(e,t){-1===e.$$.dirty[0]&&(w.push(e),S||(S=!0,L.then(U)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function B(t,i,r,o,l,c,u=[-1]){const a=O;R(t);const d=i.props||{},f=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:u,skip_bound:!1};let m=!1;if(f.ctx=r?r(t,d,((e,n,...s)=>{const i=s.length?s[0]:n;return f.ctx&&l(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),m&&J(t,e)),n})):[],f.update(),m=!0,s(f.before_update),f.fragment=!!o&&o(f.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);f.fragment&&f.fragment.l(e),e.forEach(h)}else f.fragment&&f.fragment.c();i.intro&&F(t.$$.fragment),V(t,i.target,i.anchor),U()}R(a)}class G{$destroy(){q(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Y{static listeners={};static logEvents=!0;static listen(e,t){"function"==typeof t&&(void 0===this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push(t))}static trigger(e,t){"object"!=typeof t&&(t={value:t}),this.logEvents&&(console.log("EventHub >> "+String(e)),console.log(t));for(let n of this.listeners[e]||[])try{n(Object.assign({},t))}catch(t){console.log("Error while handling event "+String(e)),console.log(t)}}}const Z=Object.freeze({DICE_INFO:Symbol("dice-info"),ROLL_DICE:Symbol("roll-dice")}),Q=Object.freeze({ROOM_ENTERED:Symbol("room-entered"),ROOM_USER_JOIN:Symbol("room-usr-join"),ROOM_USER_LEAVE:Symbol("room-user-leave")}),X=Object.freeze({NETWORK_CONNECTING:Symbol("network-connecting"),NETWORK_CONNECTED:Symbol("network-connected"),NETWORK_UNAVAILABLE:Symbol("network-unavailable"),NETWORK_FAILED:Symbol("network-failed"),NETWORK_DISCONNECTED:Symbol("network-disconnected")});function ee(e){let t=String(e);return 0===t.indexOf("Symbol(")&&(t=t.substr(7,t.length-8)),t}class te{pusherLibrary="https://js.pusher.com/7.0/pusher.min.js";client=null;channel=null;settings={authEndpoint:"",appKey:"",appCluster:"eu"};constructor(e){for(let t in this.settings)this.settings[t]=e[t]??this.settings[t];this.injectPusher()}injectPusher(){let e=document.createElement("script");e.src=this.pusherLibrary,document.head.append(e)}initialize(e){window.Pusher&&(this.client=new Pusher(this.settings.appKey,{cluster:this.settings.appCluster,authEndpoint:this.settings.authEndpoint,auth:{params:{name:e}}}),this.client.connection.bind("error",this.handleConnectionError.bind(this)),this.client.connection.bind("state_change",this.handleConnectionStateChange.bind(this)))}connect(e,t){this.disconnect(),this.initialize(t),e=("presence-"+e).toLowerCase().replace(/[^a-z0-9-_]/g,""),this.channel=this.client.subscribe(e),this.channel.bind("pusher:subscription_succeeded",(e=>{Y.trigger(Q.ROOM_ENTERED,e)})),this.channel.bind("pusher:subscription_error",(t=>{Y.trigger(X.NETWORK_FAILED),this.log("subscription error on "+e,t)})),this.channel.bind("pusher:member_added",(e=>{Y.trigger(Q.ROOM_USER_JOIN,e)})),this.channel.bind("pusher:member_removed",(e=>{Y.trigger(Q.ROOM_USER_LEAVE,e)}));for(let e in Z){let t="client-"+ee(Z[e]);this.channel.bind(t,(e=>(t,n)=>{t.sender=n.user_id,Y.trigger(e,t)})(Z[e])),this.log("subscribed to "+t)}return e}disconnect(){this.channel&&(this.channel.unsubscribe(),this.channel.disconnect(),this.channel=null),this.client&&this.client.disconnect()}send(e,t,n){if(!this.channel||!this.channel.subscribed)return;let s=ee(e);0!==s.indexOf("client-")&&(s="client-"+s),this.channel.trigger(s,t),n&&(t.sender=n,Y.trigger(e,t))}handleConnectionStateChange(e){switch(this.log("connection state change",e),e.current){case"connecting":Y.trigger(X.NETWORK_CONNECTING);break;case"connected":Y.trigger(X.NETWORK_CONNECTED);break;case"disconnected":Y.trigger(X.NETWORK_DISCONNECTED),this.channel=null;break;case"failed":Y.trigger(X.NETWORK_FAILED),this.channel=null;break;case"unavailable":Y.trigger(X.NETWORK_UNAVAILABLE),this.channel=null}}handleConnectionError(e){this.log("error",e),4004===e.error.data.code&&this.log("connection limit reached"),Y.trigger(X.NETWORK_FAILED)}log(e,t){console.log("pusher >> "+e),t&&console.log(t)}}class ne{room="";self={id:0,info:{},firstUser:!1};users={};userlist=[];dices=[];rolls=[];status=se.SETUP;network=null;constructor(e){this.setupListeners(),this.network=new te(e.network||{}),this.status=se.READY,this.updated()}joinRoom(e,t){this.room=this.network.connect(e,t)}leaveRoom(){this.network.disconnect()}roll(e){if(e=e||0,this.dices[e]===this.self.id){let t=Math.floor(6*Math.random())+1,n=0;for(;n<this.userlist.length&&this.userlist[n].id!==this.self.id;n++);return n++,n>=this.userlist.length&&(n=0),this.network.send(Z.ROLL_DICE,{dice:e,eyes:t,next:this.userlist[n].id},this.self.id),t}return 0}addDice(){return this.dices.push(this.self.id),this.sendDiceInfo(),this.updated(),this.self.id}canRoll(){let e=[];for(let t=0;t<this.dices.length;t++)this.dices[t]===this.self.id&&e.push(t);return e}sendDiceInfo(){this.network.send(Z.DICE_INFO,{dices:this.dices.slice()})}updateUserList(){this.userlist.length=0;for(let e in this.users)this.userlist.push(this.users[e]);this.userlist.sort(((e,t)=>e.id>t.id?1:e.id<t.id?-1:0)),this.updated()}updated(){document.body.dispatchEvent(new Event("dice-pusher-updated"))}setupListeners(){window.addEventListener("beforeunload",(()=>(this.leaveRoom(),null))),Y.listen(X.NETWORK_CONNECTED,(()=>{this.status=se.CONNECTING,this.updated()})),Y.listen(X.NETWORK_DISCONNECTED,(()=>{this.status=se.READY,this.updated()})),Y.listen(X.NETWORK_FAILED,(()=>{this.status=se.ERROR,this.updated()})),Y.listen(X.NETWORK_UNAVAILABLE,(()=>{this.status=se.ERROR,this.updated()})),Y.listen(Q.ROOM_ENTERED,(e=>{if(this.status=se.CONNECTED,e.me&&(this.self=e.me),e.members){this.users={};for(let t in e.members)this.users[t]=e.members[t]||{},this.users[t].id=t}this.updateUserList(),1===this.userlist.length&&(this.self.firstUser=!0,this.dices=[this.self.id]),this.forwardEvent(Q.ROOM_ENTERED,this.users)})),Y.listen(Q.ROOM_USER_JOIN,(e=>{this.users[e.id]=e.info,this.users[e.id].id=e.id,this.self.id===this.userlist[0].id&&this.sendDiceInfo(),this.updateUserList(),this.forwardEvent(Q.ROOM_USER_JOIN,this.users)})),Y.listen(Q.ROOM_USER_LEAVE,(e=>{delete this.users[e.id],1===this.userlist.length&&(this.firstUser=!0),this.updateUserList(),this.forwardEvent(Q.ROOM_USER_LEAVE,this.users)})),Y.listen(Z.DICE_INFO,(e=>{this.dices=e.dices.slice(),this.updated(),this.forwardEvent(Z.DICE_INFO,e)})),Y.listen(Z.ROLL_DICE,(e=>{this.rolls.push(e),this.dices[e.dice]=e.next,this.updated(),this.forwardEvent(Z.ROLL_DICE,e)}))}forwardEvent(e,t){document.body&&document.body.dispatchEvent(new Event(ee(e),t))}}const se=Object.freeze({SETUP:Symbol("setup"),READY:Symbol("ready"),CONNECTING:Symbol("connecting"),CONNECTED:Symbol("connected"),ERROR:Symbol("error")});function ie(e){let t,n;const s=e[3].default,i=o(s,e,e[2],null);return{c(){t=m("div"),i&&i.c(),b(t,"class","card svelte-tbjk5t"),v(t,"inactive",e[0])},m(e,s){d(e,t,s),i&&i.m(t,null),n=!0},p(e,[n]){i&&i.p&&4&n&&c(i,s,e,e[2],n,null,null),1&n&&v(t,"inactive",e[0])},i(e){n||(F(i,e),n=!0)},o(e){P(i,e),n=!1},d(e){e&&h(t),i&&i.d(e)}}}function re(e,t,n){let s,{$$slots:i={},$$scope:r}=t,{inactive:o=!1}=t;return e.$$set=e=>{"inactive"in e&&n(1,o=e.inactive),"$$scope"in e&&n(2,r=e.$$scope)},e.$$.update=()=>{2&e.$$.dirty&&n(0,s=o)},[s,o,r,i]}class oe extends G{constructor(e){super(),B(this,e,re,ie,r,{inactive:1})}}function le(t){let n;return{c(){n=m("header"),n.innerHTML='<img src="img/cody.png" alt="Cody rolls" class="svelte-txuxrt"/> \n\n    <h1 class="svelte-txuxrt">Let&#39;s roll together!</h1>',b(n,"class","svelte-txuxrt")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}class ce extends G{constructor(e){super(),B(this,e,null,le,r,{})}}function ue(t){let n;return{c(){n=m("footer"),n.innerHTML='<div class="copyright svelte-7gpmal">Nicole Heinze - 2020</div>',b(n,"class","svelte-7gpmal")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}class ae extends G{constructor(e){super(),B(this,e,null,ue,r,{})}}function de(t){let n;return{c(){n=m("div"),n.textContent="An Error Occured"},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}class he extends G{constructor(e){super(),B(this,e,null,de,r,{})}}function fe(t){let n;return{c(){n=m("div"),n.textContent="Setting up..."},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}class me extends G{constructor(e){super(),B(this,e,null,fe,r,{})}}function pe(e){let t,n,s,i,r;const l=e[4].default,a=o(l,e,e[3],null);return{c(){t=m("button"),a&&a.c(),b(t,"class",n=u(e[0])+" svelte-13uk50i"),v(t,"flat",e[1]),v(t,"inverse",e[2])},m(n,o){d(n,t,o),a&&a.m(t,null),s=!0,i||(r=E(t,"click",e[5]),i=!0)},p(e,[i]){a&&a.p&&8&i&&c(a,l,e,e[3],i,null,null),(!s||1&i&&n!==(n=u(e[0])+" svelte-13uk50i"))&&b(t,"class",n),3&i&&v(t,"flat",e[1]),5&i&&v(t,"inverse",e[2])},i(e){s||(F(a,e),s=!0)},o(e){P(a,e),s=!1},d(e){e&&h(t),a&&a.d(e),i=!1,r()}}}function ge(e,t,n){let{$$slots:s={},$$scope:i}=t,{type:r="primary"}=t,{flat:o=!0}=t,{inverse:l=!1}=t;return e.$$set=e=>{"type"in e&&n(0,r=e.type),"flat"in e&&n(1,o=e.flat),"inverse"in e&&n(2,l=e.inverse),"$$scope"in e&&n(3,i=e.$$scope)},[r,o,l,i,s,function(t){C(e,t)}]}class $e extends G{constructor(e){super(),B(this,e,ge,pe,r,{type:0,flat:1,inverse:2})}}function Ee(e){let t;return{c(){t=p("Tritt ein")},m(e,n){d(e,t,n)},d(e){e&&h(t)}}}function be(e){let t,n,i,r,o,l,c,u,f,$,v,O,R,_,C,w,D,x,T,L,S,k,I,A,U;return k=new $e({props:{type:"secondary",$$slots:{default:[Ee]},$$scope:{ctx:e}}}),{c(){t=m("h3"),t.textContent="Willkommen beim Accso Wichtelgewusel",n=g(),i=m("div"),r=m("form"),o=m("div"),l=m("label"),l.textContent="Raum",c=g(),u=m("input"),f=g(),$=m("div"),v=p(e[1]),O=g(),R=m("label"),R.textContent="Dein Name",_=g(),C=m("input"),w=g(),D=m("div"),x=p(e[2]),T=g(),L=m("br"),S=g(),H(k.$$.fragment),b(l,"for","room-id"),b(l,"class","svelte-l9wtqe"),b(u,"type","text"),b(u,"placeholder","Fancy-room-name"),b(u,"class","svelte-l9wtqe"),b($,"class","error svelte-l9wtqe"),b(R,"for","room-id"),b(R,"class","svelte-l9wtqe"),b(C,"type","text"),b(C,"placeholder","Dicey McDiceface"),b(C,"class","svelte-l9wtqe"),b(D,"class","error svelte-l9wtqe"),b(o,"class","join")},m(s,h){var m;d(s,t,h),d(s,n,h),d(s,i,h),a(i,r),a(r,o),a(o,l),a(o,c),a(o,u),N(u,e[0].roomName),a(o,f),a(o,$),a($,v),a(o,O),a(o,R),a(o,_),a(o,C),N(C,e[0].playerName),a(o,w),a(o,D),a(D,x),a(o,T),a(o,L),a(o,S),V(k,o,null),I=!0,A||(U=[E(u,"input",e[5]),E(C,"input",e[6]),E(r,"submit",(m=e[3],function(e){return e.preventDefault(),m.call(this,e)})),E(i,"submit",e[4])],A=!0)},p(e,[t]){1&t&&u.value!==e[0].roomName&&N(u,e[0].roomName),(!I||2&t)&&y(v,e[1]),1&t&&C.value!==e[0].playerName&&N(C,e[0].playerName),(!I||4&t)&&y(x,e[2]);const n={};512&t&&(n.$$scope={dirty:t,ctx:e}),k.$set(n)},i(e){I||(F(k.$$.fragment,e),I=!0)},o(e){P(k.$$.fragment,e),I=!1},d(e){e&&h(t),e&&h(n),e&&h(i),q(k),A=!1,s(U)}}}function ye(e,t,n){let s=_(),{credentials:i={roomName:"",playerName:""}}=t,r="",o="",l=!1;return e.$$set=e=>{"credentials"in e&&n(0,i=e.credentials)},[i,r,o,()=>{l=!0,i.roomName.trim().length<3&&(n(1,r="Der Raum name ist zu kurz..."),l=!1),i.playerName.trim().length<1&&(n(2,o="Hast du keinen Namen?"),l=!1),i.playerName.trim().length>10&&(n(2,o="Uhh... der Name ist ein bisschen zu lang (mehr als 10 Zeichen)"),l=!1),l&&(n(1,r=""),s("joinRoom",i))},function(t){C(e,t)},function(){i.roomName=this.value,n(0,i)},function(){i.playerName=this.value,n(0,i)}]}class Ne extends G{constructor(e){super(),B(this,e,ye,be,r,{credentials:0})}}function ve(e,t,n){const s=e.slice();return s[15]=t[n],s}function Oe(e,t,n){const s=e.slice();return s[18]=t[n],s}function Re(e,t,n){const s=e.slice();return s[18]=t[n],s}function _e(e,t,n){const s=e.slice();return s[23]=t[n],s}function Ce(e){let t,n,s,i;return t=new $e({props:{$$slots:{default:[we]},$$scope:{ctx:e}}}),t.$on("click",e[7]),{c(){H(t.$$.fragment),n=g(),s=m("br")},m(e,r){V(t,e,r),d(e,n,r),d(e,s,r),i=!0},p(e,n){const s={};67108864&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){i||(F(t.$$.fragment,e),i=!0)},o(e){P(t.$$.fragment,e),i=!1},d(e){q(t,e),e&&h(n),e&&h(s)}}}function we(e){let t;return{c(){t=p("Add Dice")},m(e,n){d(e,t,n)},d(e){e&&h(t)}}}function De(e){let t,n,s=e[0].room+"";return{c(){t=p("Room "),n=p(s)},m(e,s){d(e,t,s),d(e,n,s)},p(e,t){1&t&&s!==(s=e[0].room+"")&&y(n,s)},d(e){e&&h(t),e&&h(n)}}}function xe(e){let t,n,s,i,r=e[23].message+"";return{c(){t=m("span"),n=p(r),s=g(),b(t,"class",i=u(e[23].style)+" svelte-jt7zh5")},m(e,i){d(e,t,i),a(t,n),a(t,s)},p(e,s){16&s&&r!==(r=e[23].message+"")&&y(n,r),16&s&&i!==(i=u(e[23].style)+" svelte-jt7zh5")&&b(t,"class",i)},d(e){e&&h(t)}}}function Te(e){let t,n,s,i,r,o,l,c,u,p=e[5],$=[];for(let t=0;t<p.length;t+=1)$[t]=ze(Re(e,p,t));const E=e=>P($[e],1,1,(()=>{$[e]=null}));let b=e[0].userlist,y=[];for(let t=0;t<b.length;t+=1)y[t]=He(ve(e,b,t));return{c(){t=m("div");for(let e=0;e<$.length;e+=1)$[e].c();n=g(),s=m("div"),i=m("br"),r=g(),o=m("b"),o.textContent="Spieler:innen",l=m("br"),c=g();for(let e=0;e<y.length;e+=1)y[e].c()},m(e,h){d(e,t,h);for(let e=0;e<$.length;e+=1)$[e].m(t,null);d(e,n,h),d(e,s,h),a(s,i),a(s,r),a(s,o),a(s,l),a(s,c);for(let e=0;e<y.length;e+=1)y[e].m(s,null);u=!0},p(e,n){if(1836&n){let s;for(p=e[5],s=0;s<p.length;s+=1){const i=Re(e,p,s);$[s]?($[s].p(i,n),F($[s],1)):($[s]=ze(i),$[s].c(),F($[s],1),$[s].m(t,null))}for(K(),s=p.length;s<$.length;s+=1)E(s);W()}if(35&n){let t;for(b=e[0].userlist,t=0;t<b.length;t+=1){const i=ve(e,b,t);y[t]?y[t].p(i,n):(y[t]=He(i),y[t].c(),y[t].m(s,null))}for(;t<y.length;t+=1)y[t].d(1);y.length=b.length}},i(e){if(!u){for(let e=0;e<p.length;e+=1)F($[e]);u=!0}},o(e){$=$.filter(Boolean);for(let e=0;e<$.length;e+=1)P($[e]);u=!1},d(e){e&&h(t),f($,e),e&&h(n),e&&h(s),f(y,e)}}}function Le(t){let n,s;return n=new Ne({}),n.$on("joinRoom",t[6]),{c(){H(n.$$.fragment)},m(e,t){V(n,e,t),s=!0},p:e,i(e){s||(F(n.$$.fragment,e),s=!0)},o(e){P(n.$$.fragment,e),s=!1},d(e){q(n,e)}}}function Se(t){let n,s;return n=new he({}),{c(){H(n.$$.fragment)},m(e,t){V(n,e,t),s=!0},p:e,i(e){s||(F(n.$$.fragment,e),s=!0)},o(e){P(n.$$.fragment,e),s=!1},d(e){q(n,e)}}}function ke(t){let n,s;return n=new me({}),{c(){H(n.$$.fragment)},m(e,t){V(n,e,t),s=!0},p:e,i(e){s||(F(n.$$.fragment,e),s=!0)},o(e){P(n.$$.fragment,e),s=!1},d(e){q(n,e)}}}function Ie(e){let t,n,s,i=!e[2][e[18].id]&&Ae(e);return n=new oe({props:{inactive:e[3][e[18].id],$$slots:{default:[Me]},$$scope:{ctx:e}}}),{c(){i&&i.c(),t=g(),H(n.$$.fragment)},m(e,r){i&&i.m(e,r),d(e,t,r),V(n,e,r),s=!0},p(e,s){e[2][e[18].id]?i&&(i.d(1),i=null):i?i.p(e,s):(i=Ae(e),i.c(),i.m(t.parentNode,t));const r={};40&s&&(r.inactive=e[3][e[18].id]),67108900&s&&(r.$$scope={dirty:s,ctx:e}),n.$set(r)},i(e){s||(F(n.$$.fragment,e),s=!0)},o(e){P(n.$$.fragment,e),s=!1},d(e){i&&i.d(e),e&&h(t),q(n,e)}}}function Ae(e){let t,n=e[10](e[18].id)+"";return{c(){t=p(n)},m(e,n){d(e,t,n)},p(e,s){32&s&&n!==(n=e[10](e[18].id)+"")&&y(t,n)},d(e){e&&h(t)}}}function Ue(e){let t,n,s,i,r,o,l,c=e[18].user.name+"";return{c(){t=m("p"),n=p(c),s=m("br"),i=p("ist dran."),r=g(),o=m("img"),o.src!==(l=e[9][e[2][e[18].id].eyes].src+"?"+e[2][e[18].id].timestamp)&&b(o,"src",l),b(o,"alt","Dice")},m(e,l){d(e,t,l),a(t,n),a(t,s),a(t,i),d(e,r,l),d(e,o,l)},p(e,t){32&t&&c!==(c=e[18].user.name+"")&&y(n,c),36&t&&o.src!==(l=e[9][e[2][e[18].id].eyes].src+"?"+e[2][e[18].id].timestamp)&&b(o,"src",l)},d(e){e&&h(t),e&&h(r),e&&h(o)}}}function je(e){let t,n,s,i,r,o;function l(){return e[11](e[18])}return{c(){t=m("p"),t.innerHTML="<b>Du<br/>bist dran!</b>",n=g(),s=m("img"),s.src!==(i=e[9][e[2][e[18].id].eyes].src+"?"+e[2][e[18].id].timestamp)&&b(s,"src",i),b(s,"alt","Dice")},m(e,i){d(e,t,i),d(e,n,i),d(e,s,i),r||(o=E(s,"click",l),r=!0)},p(t,n){e=t,36&n&&s.src!==(i=e[9][e[2][e[18].id].eyes].src+"?"+e[2][e[18].id].timestamp)&&b(s,"src",i)},d(e){e&&h(t),e&&h(n),e&&h(s),r=!1,o()}}}function Me(e){let t,n;function s(e,t){return e[18].yourTurn?je:Ue}let i=s(e),r=i(e);return{c(){t=m("div"),r.c(),n=g(),b(t,"class","diespace svelte-jt7zh5")},m(e,s){d(e,t,s),r.m(t,null),d(e,n,s)},p(e,n){i===(i=s(e))&&r?r.p(e,n):(r.d(1),r=i(e),r&&(r.c(),r.m(t,null)))},d(e){e&&h(t),r.d(),e&&h(n)}}}function ze(e){let t,n,s=e[18].user&&Ie(e);return{c(){s&&s.c(),t=$()},m(e,i){s&&s.m(e,i),d(e,t,i),n=!0},p(e,n){e[18].user?s?(s.p(e,n),32&n&&F(s,1)):(s=Ie(e),s.c(),F(s,1),s.m(t.parentNode,t)):s&&(K(),P(s,1,1,(()=>{s=null})),W())},i(e){n||(F(s),n=!0)},o(e){P(s),n=!1},d(e){s&&s.d(e),e&&h(t)}}}function Ke(e){let t,n,s,i,r=e[15].name+"",o=e[5],l=[];for(let t=0;t<o.length;t+=1)l[t]=Pe(Oe(e,o,t));return{c(){t=p(r),n=g();for(let e=0;e<l.length;e+=1)l[e].c();s=g(),i=m("br")},m(e,r){d(e,t,r),d(e,n,r);for(let t=0;t<l.length;t+=1)l[t].m(e,r);d(e,s,r),d(e,i,r)},p(e,n){if(1&n&&r!==(r=e[15].name+"")&&y(t,r),33&n){let t;for(o=e[5],t=0;t<o.length;t+=1){const i=Oe(e,o,t);l[t]?l[t].p(i,n):(l[t]=Pe(i),l[t].c(),l[t].m(s.parentNode,s))}for(;t<l.length;t+=1)l[t].d(1);l.length=o.length}},d(e){e&&h(t),e&&h(n),f(l,e),e&&h(s),e&&h(i)}}}function We(e){let t,n=e[18].user.id===e[15].id&&Fe();return{c(){n&&n.c(),t=$()},m(e,s){n&&n.m(e,s),d(e,t,s)},p(e,s){e[18].user.id===e[15].id?n||(n=Fe(),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&h(t)}}}function Fe(e){let t;return{c(){t=p("🎲")},m(e,n){d(e,t,n)},d(e){e&&h(t)}}}function Pe(e){let t,n=e[18].user&&We(e);return{c(){n&&n.c(),t=$()},m(e,s){n&&n.m(e,s),d(e,t,s)},p(e,s){e[18].user?n?n.p(e,s):(n=We(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&h(t)}}}function He(e){let t,n=-1===e[1].indexOf(e[15].id),s=n&&Ke(e);return{c(){s&&s.c(),t=$()},m(e,n){s&&s.m(e,n),d(e,t,n)},p(e,i){3&i&&(n=-1===e[1].indexOf(e[15].id)),n?s?s.p(e,i):(s=Ke(e),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(e){s&&s.d(e),e&&h(t)}}}function Ve(e){let t,n,s,i,r,o,l,c,u,p,$,E,y,N;t=new ce({});let v=!0===e[0].self.firstUser&&Ce(e),O=e[0].status===se.CONNECTED&&De(e),R=e[4],_=[];for(let t=0;t<R.length;t+=1)_[t]=xe(_e(e,R,t));const C=[ke,Se,Le,Te],w=[];function D(e,t){return e[0].status===se.SETUP?0:e[0].status===se.ERROR?1:e[0].status===se.READY?2:e[0].status===se.CONNECTED?3:-1}return~(p=D(e))&&($=w[p]=C[p](e)),y=new ae({}),{c(){H(t.$$.fragment),n=g(),s=m("div"),v&&v.c(),i=g(),O&&O.c(),r=g(),o=m("div");for(let e=0;e<_.length;e+=1)_[e].c();l=g(),c=m("main"),u=m("div"),$&&$.c(),E=g(),H(y.$$.fragment),b(s,"class","setting svelte-jt7zh5"),b(o,"class","eventlog svelte-jt7zh5"),b(u,"class","gamearea svelte-jt7zh5"),b(c,"class","svelte-jt7zh5")},m(e,h){V(t,e,h),d(e,n,h),d(e,s,h),v&&v.m(s,null),a(s,i),O&&O.m(s,null),d(e,r,h),d(e,o,h);for(let e=0;e<_.length;e+=1)_[e].m(o,null);d(e,l,h),d(e,c,h),a(c,u),~p&&w[p].m(u,null),d(e,E,h),V(y,e,h),N=!0},p(e,[t]){if(!0===e[0].self.firstUser?v?(v.p(e,t),1&t&&F(v,1)):(v=Ce(e),v.c(),F(v,1),v.m(s,i)):v&&(K(),P(v,1,1,(()=>{v=null})),W()),e[0].status===se.CONNECTED?O?O.p(e,t):(O=De(e),O.c(),O.m(s,null)):O&&(O.d(1),O=null),16&t){let n;for(R=e[4],n=0;n<R.length;n+=1){const s=_e(e,R,n);_[n]?_[n].p(s,t):(_[n]=xe(s),_[n].c(),_[n].m(o,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=R.length}let n=p;p=D(e),p===n?~p&&w[p].p(e,t):($&&(K(),P(w[n],1,1,(()=>{w[n]=null})),W()),~p?($=w[p],$?$.p(e,t):($=w[p]=C[p](e),$.c()),F($,1),$.m(u,null)):$=null)},i(e){N||(F(t.$$.fragment,e),F(v),F($),F(y.$$.fragment,e),N=!0)},o(e){P(t.$$.fragment,e),P(v),P($),P(y.$$.fragment,e),N=!1},d(e){q(t,e),e&&h(n),e&&h(s),v&&v.d(),O&&O.d(),e&&h(r),e&&h(o),f(_,e),e&&h(l),e&&h(c),~p&&w[p].d(),e&&h(E),q(y,e)}}}function qe(e,t,n){let s={roomName:"",playerName:""};document.body.addEventListener("dice-pusher-updated",(()=>{n(0,l),console.log("Updated DicePusher")})),Y.listen(Z.ROLL_DICE,(e=>{n(2,c[e.dice]={eyes:e.eyes,timestamp:Date.now()},c),console.log("Last Rolls: "+c);let t=l.userlist.find((t=>t.id===e.sender)).name,s="none";6===e.eyes&&(s="bold"),n(3,u[e.dice]=!0,u),a[e.dice]="inactive",window.setTimeout((()=>{a[e.dice]="active",n(3,u[e.dice]=!1,u),i(t+" hat eine "+e.eyes+" gewürfelt",s)}),3e3)})),Y.listen(Q.ROOM_USER_JOIN,(e=>{console.log("User Joined Room: "+e.info.name),console.log("Current users: "),i(e.info.name+" kommt in den Raum geschliddert")})),Y.listen(Q.ROOM_USER_LEAVE,(e=>{console.log("User Left Room: "+e.info.name),i(e.info.name+" ist gegangen... :( "),d.push(e.id),console.log("Missing dice: "+d)}));const i=(e,t)=>{let s=t||"none";h.unshift({id:h.length,message:e,style:s}),n(4,h)},r=e=>{u[e]||l.roll(e)};let o=[];for(let e=0;e<7;e++){let t=new Image;t.src="img/"+(e||1)+".gif",o.push(t)}let l,c,u,a,d,h,f;return e.$$.update=()=>{3&e.$$.dirty&&n(5,f=l.dices.map(((e,t)=>{if(-1===d.indexOf(t)){let n={};return n.id=t,n.user=l.users[e],n.yourTurn=!1,n.user&&n.user.id===l.self.id&&(n.yourTurn=!0),n}})))},n(0,l=new ne({network:{authEndpoint:"//gheist.net/api/pusher/auth/generic/presence/1098358",appKey:"d209ebf4ad2e3647739c"}})),n(2,c=[{eyes:1,timestamp:0}]),n(3,u=[]),a=[],n(1,d=[]),n(4,h=[]),[l,d,c,u,h,f,e=>{s=e.detail,console.log("User "+s.playerName+" is joining room "+s.roomName),i("Hallo "+s.playerName),l.joinRoom(s.roomName,s.playerName)},()=>{l.addDice(),c.push({eyes:1,timestamp:0}),i("Huch! Ein neuer Würfel!")},r,o,e=>{console.log("init last roll "+e),n(2,c[e]=c[e]||{eyes:1,timestamp:0},c)},e=>r(e.id)]}return new class extends G{constructor(e){super(),B(this,e,qe,Ve,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
